\section{Implementasi Praktis}

Dalam bagian ini, kita akan melihat contoh implementasi optimizer sederhana yang menggabungkan beberapa optimasi dasar.

\subsection{Struktur Optimizer}

\begin{lstlisting}[language=C++, caption=Struktur dasar optimizer]
class Optimizer {
private:
    vector<BasicBlock> basicBlocks;
    ControlFlowGraph cfg;
    
public:
    // Identifikasi basic blocks
    void identifyBasicBlocks(const vector<Instruction>& insts);
    
    // Optimasi lokal dalam basic block
    void optimizeBasicBlock(BasicBlock& block);
    
    // Optimasi global lintas basic blocks
    void optimizeGlobal();
    
    // Kombinasi semua optimasi
    vector<Instruction> optimize(const vector<Instruction>& insts);
};

vector<Instruction> Optimizer::optimize(
    const vector<Instruction>& instructions) {
    
    // 1. Identifikasi basic blocks
    identifyBasicBlocks(instructions);
    
    // 2. Optimasi lokal untuk setiap basic block
    for (auto& block : basicBlocks) {
        optimizeBasicBlock(block);
    }
    
    // 3. Optimasi global
    optimizeGlobal();
    
    // 4. Reconstruct instructions dari basic blocks
    return reconstructInstructions();
}

void Optimizer::optimizeBasicBlock(BasicBlock& block) {
    bool changed = true;
    
    while (changed) {
        changed = false;
        
        // Constant folding
        changed |= constantFolding(block);
        
        // Constant propagation
        changed |= constantPropagation(block);
        
        // Dead code elimination
        changed |= deadCodeElimination(block);
    }
}
\end{lstlisting}