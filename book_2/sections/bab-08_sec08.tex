\section{Semantic Actions untuk Membangun AST}

Salah satu penggunaan utama semantic actions adalah untuk membangun \textbf{Abstract Syntax Tree (AST)}. Mari kita lihat contoh yang lebih kompleks.

\subsection{Struktur AST Node}

Pertama, kita definisikan struktur untuk AST node:

\begin{lstlisting}[language=C, caption={Definisi AST node}]
typedef enum {
    NODE_NUMBER,
    NODE_ADD,
    NODE_SUB,
    NODE_MUL,
    NODE_DIV
} NodeType;

typedef struct ASTNode {
    NodeType type;
    double value;  // Untuk NODE_NUMBER
    struct ASTNode *left;   // Untuk operasi binary
    struct ASTNode *right;
} ASTNode;

ASTNode* create_number_node(double value) {
    ASTNode *node = malloc(sizeof(ASTNode));
    node->type = NODE_NUMBER;
    node->value = value;
    node->left = node->right = NULL;
    return node;
}

ASTNode* create_binary_node(NodeType type, ASTNode *left, ASTNode *right) {
    ASTNode *node = malloc(sizeof(ASTNode));
    node->type = type;
    node->left = left;
    node->right = right;
    return node;
}
\end{lstlisting}

\subsection{Grammar dengan AST Building}

\begin{lstlisting}[language=C, caption={Grammar dengan semantic actions untuk AST}]
%union {
    double dval;
    ASTNode *astnode;
}

%token <dval> NUMBER
%type <astnode> expr

%%
expr:
    NUMBER { $$ = create_number_node($1); }
  | expr '+' expr { $$ = create_binary_node(NODE_ADD, $1, $3); }
  | expr '-' expr { $$ = create_binary_node(NODE_SUB, $1, $3); }
  | expr '*' expr { $$ = create_binary_node(NODE_MUL, $1, $3); }
  | expr '/' expr { $$ = create_binary_node(NODE_DIV, $1, $3); }
  | '(' expr ')' { $$ = $2; }
  ;
\end{lstlisting}